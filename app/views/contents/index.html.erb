<h1>Contents#index</h1>
<%= render "shared/header" %>

<% if user_signed_in? %>
  <div class='user__name'>
    <%= link_to current_user.name, user_path(current_user.id), class: :mypage__link %>
  </div>
<% end %>

<div class='contents'>
  <h2 class='title'>コンテンツ一覧</h2>

    <%= form_with(url: search_contents_path, local: true, method: :get, class: "search-form") do |form| %>
    <%= form.text_field :keyword, placeholder: "投稿コンテンツを検索", class: "search-input" %>
    <%= form.submit "検索", class: "search-btn" %>
    <% end %>

  <ul class='content__lists'>

    <% @contents.each do |content| %>
      <li class='list'>
        <%= link_to content_path(content.id) do %>
        <div class='content__img'>
          <% if content.video_content.present? %>
            <%= video_tag(content.video_content.url, :controls => true, width: "320px")  %>
          <% else %>
            <div class="image__content" >
            <%= image_tag content.image_content.url, width: '320px' %>
            </div>
          <% end %>
        </div>
        <div class='content__info'>
          <h3 class='content__title'>
            <%= content.title %>
          </h3>
          <p class='content__overview'>
            <%=safe_join(content.overview.split("\n"),tag(:br))%>
          </p>
          <p class='content__user_name'>
            <%= link_to content.user.name, user_path(content.user.id) %><br />
          </p>
          <p class='content__user_occupation'>
            <%= link_to content.user.occupation, user_path(content.user.id) %><br />
          </p>
          <%= render partial: 'contents/contents', locals: { content: content } %>
        </div>
        <% end %>
      </li>
    <% end %>
  </ul>
</div>
<% if can? :update, current_user %>
  <h1>You can update becouse you're a contributor</h1>
<% end %>
<% if can? :read, current_user %>
  <h1>You can read this as a student or a contributor</h1>
<% end %>